<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="http://localhost:4000/style/main.css"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>How to make HTTP GET/POST Requests in Unity 5 C# | Fling Engine</title>
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="How to make HTTP GET/POST Requests in Unity 5 C#" />
<meta name="author" content="Ben Hoffman" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Recently I have been doing a lot with GET and PUT requests to get JSON data from a server. Throughout my time working on this project, I noticed that the examples provided by Unity for using the WWW class for POST headers, is geared more towards SQL databases, and they make a lot of assumptions about your server configuration." />
<meta property="og:description" content="Recently I have been doing a lot with GET and PUT requests to get JSON data from a server. Throughout my time working on this project, I noticed that the examples provided by Unity for using the WWW class for POST headers, is geared more towards SQL databases, and they make a lot of assumptions about your server configuration." />
<link rel="canonical" href="http://localhost:4000/demo/general/2017/03/03/how-to-make-http-post-requests-in-unity-5-c.html" />
<meta property="og:url" content="http://localhost:4000/demo/general/2017/03/03/how-to-make-http-post-requests-in-unity-5-c.html" />
<meta property="og:site_name" content="Fling Engine" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-03-03T07:11:54-05:00" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/demo/general/2017/03/03/how-to-make-http-post-requests-in-unity-5-c.html"},"@type":"BlogPosting","dateModified":"2017-03-03T07:11:54-05:00","url":"http://localhost:4000/demo/general/2017/03/03/how-to-make-http-post-requests-in-unity-5-c.html","author":{"@type":"Person","name":"Ben Hoffman"},"headline":"How to make HTTP GET/POST Requests in Unity 5 C#","description":"Recently I have been doing a lot with GET and PUT requests to get JSON data from a server. Throughout my time working on this project, I noticed that the examples provided by Unity for using the WWW class for POST headers, is geared more towards SQL databases, and they make a lot of assumptions about your server configuration.","datePublished":"2017-03-03T07:11:54-05:00","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<!--<link rel="stylesheet" href="/assets/main.css"> --><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Fling Engine" />


</head>
<body>

    <div id="mainContent">

      <div class="container borderXwidth">
  <a href="http://localhost:4000/index.html#mainContent">HOME</a>
</div>

        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">How to make HTTP GET/POST Requests in Unity 5 C#</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2017-03-03T07:11:54-05:00" itemprop="datePublished">Mar 3, 2017
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Ben Hoffman</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Recently I have been doing a lot with GET and PUT requests to get JSON data from a server. Throughout my time working on this project, I noticed that the examples provided by Unity for using the <a href="https://docs.unity3d.com/ScriptReference/WWW.html" target="_blank">WWW</a> class for POST headers, is geared more towards SQL databases, and they make a lot of assumptions about your server configuration.</p>

<h3 id="why-use-the-www-class">Why use the WWW class?</h3>

<p>There a tons of ways to make HTTP requests in C#, like the <a href="https://msdn.microsoft.com/en-us/library/system.web.httprequest(v=vs.110).aspx" target="_blank">HttpRequest Class</a> for example. But, there is a huge problem with using classes like these at run time in Unity, and that is they run on the main thread. This means that if the thing that you a requesting is large enough (which it really doesn’t need to be that big), it can cause some pretty bad frame rates. Even if you put the request in a co-routine, then you if things fail it can get pretty complicated to handle things how you want to. Or if there is a timeout to the server, or a bad request, then everything could come crashing down.</p>

<p>The WWW class has several features about it that are useful. First of all, it is built into Unity, so you have that without having to look at a bunch of different documentations. The WWW class handles all the back end stuff for you, like opening and closing the data streams, with <em>much</em> less code. Finally, the WWW class runs on a separate thread! This means increased performance, and less chance of things hanging up your frame rate.</p>

<h2 id="how-to-implement-the-www-class">How to implement the WWW class</h2>

<p>The WWW class is simple and easy to use, but you will need a couple things first if you want to make a POST request with it.</p>

<ol>
  <li>A database set up on a server, whether it is SQL, ELK, or whatever other back end you want. This needs to be configured before you can do anything.</li>
  <li>Make sure that the firewall that is configured on the server will allow you to access the port or service that you need. This sounds obvious but it can cause a lot of frustration if you don’t catch it early.</li>
  <li>A Unity project that is hungry for some JSON data!</li>
</ol>

<p>Here is a co-routine that will make a request, and wait for it to finish before moving along.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>private IEnumerator PostJsonData(){
 // The URL of the server, and the port
 string url = "http://&amp;lt;myURL&amp;gt;:&amp;lt;my Port&amp;gt;";

 // The query that you want to send, read in from the streaming assets
 // This way we can just read in the Query once and reference it
 string query = System.IO.File.ReadAllText(Application.streamingAssetsPath + "/myQuery.json");

 // Create HTML headers
 Dictionary&amp;lt;string, string&amp;gt; headers = new Dictionary&amp;lt;string, string&amp;gt;();

 // Set the headers to be JSON format
 headers["Content-Type"] = "application/json";

 // Get the post data that I will be using, and encode it properly
 byte[] postData = Encoding.GetEncoding("UTF-8").GetBytes(query);

 // Create a web request object
 WWW myRequest = new WWW(url, postData, headers);

 // Yield until it's done:
 yield return myRequest;

 // Check if there was an error or not
 if(myRequest.error ==null)
 {
 // There was no error, you have your data!
 // Send that data to the Json Utility and get it parsed in a C# data object
 string jsonDataString = myrequest.text;

 }
 else
 {
 // Handle there being an error
 Debug.Log("There was an error in the request");
 }
}
</code></pre></div></div>

<p>Now that you have your JSON data in string format, you can use Unity’s <a href="https://docs.unity3d.com/ScriptReference/JsonUtility.html" target="_blank">JSON Utility class</a> to turn it into a C# data object. I have another post about doing that <a href="http://benhoffman.tech/index.php/2017/02/08/json-data-in-unity/">here</a>.</p>

<p>If you are interested in how to do this specifically with the ELK stack, then fear not! I have more posts about that coming, with specific instructions on how to configure it. For now I made a <a href="https://github.com/bah8892/NetworkMonitorVis" target="_blank">GitHub repo</a> with a couple useful things for creating a CentOS 7 ELK stack.</p>

<p><a href="https://unity3d.com/unity/whats-new/unity-5.5.1" target="_blank">Using Unity 5.5.1</a></p>

  </div><a class="u-url" href="/demo/general/2017/03/03/how-to-make-http-post-requests-in-unity-5-c.html" hidden></a>
</article>


    </div> <!-- End Main content -->
<footer>

  <a href="https://github.com/flingengine" target="_blank"><img src="http://localhost:4000\media\GitHub-Mark-32px.png" lat="GitHub Logo"/></a>
  <a href="https://twitter.com/benjafriend" target="_blank"><img src="http://localhost:4000\media\twitter_logo.png" lat="Twitter Logo"/></a>

  <p>&#169; Copyright Ben Hoffman 2019</p>
    
</footer>
</body>

</html>
